{{- /* Header ç»„ä»¶ - å¤åˆ» AstroWind Header.astro */ -}}
{{- $isSticky := .Site.Params.header.isSticky | default true -}}
{{- $showToggleTheme := .Site.Params.header.showToggleTheme | default true -}}
{{- $showRssFeed := .Site.Params.header.showRssFeed | default false -}}

<header 
  id="header" 
  class="{{ if $isSticky }}sticky{{ else }}relative{{ end }} top-0 z-40 flex-none w-full border-b border-gray-50/0 transition-opacity ease-in-out"
  {{ if $isSticky }}data-aw-sticky-header{{ end }}
>
  <div class="absolute inset-0"></div>
  <div class="relative text-default py-3 px-3 md:px-6 mx-auto w-full md:flex md:justify-between max-w-7xl">
    {{- /* Logo */ -}}
    <div class="flex justify-between">
      <a class="flex items-center" href="{{ .Site.Home.RelPermalink }}">
        {{- with .Site.Params.assets.logo }}
        <img src="{{ . }}" alt="{{ $.Site.Title }}" class="h-8 w-auto">
        {{- else }}
        <span class="self-center ml-2 rtl:ml-0 rtl:mr-2 text-2xl md:text-xl font-bold text-gray-900 whitespace-nowrap dark:text-white">
          ğŸš€ {{ .Site.Title }}
        </span>
        {{- end }}
      </a>
      {{- /* Mobile menu toggle - å¤åˆ» AstroWind ToggleMenu ç»„ä»¶ */ -}}
      <div class="flex items-center md:hidden">
        <button type="button" class="flex flex-col h-12 w-12 rounded justify-center items-center cursor-pointer group" aria-label="Toggle Menu" data-aw-toggle-menu>
          <span class="sr-only">Toggle Menu</span>
          <span aria-hidden="true" class="h-0.5 w-6 my-1 rounded-full bg-black dark:bg-white transition ease transform duration-200 opacity-80 group-[.expanded]:rotate-45 group-[.expanded]:translate-y-2.5"></span>
          <span aria-hidden="true" class="h-0.5 w-6 my-1 rounded-full bg-black dark:bg-white transition ease transform duration-200 opacity-80 group-[.expanded]:opacity-0"></span>
          <span aria-hidden="true" class="h-0.5 w-6 my-1 rounded-full bg-black dark:bg-white transition ease transform duration-200 opacity-80 group-[.expanded]:-rotate-45 group-[.expanded]:-translate-y-2.5"></span>
        </button>
      </div>
    </div>
    
    {{- /* Navigation - å¤åˆ» AstroWind å¯¼èˆªæ ·å¼ */ -}}
    {{- $currentPath := .RelPermalink -}}
    <nav class="items-center w-full md:w-auto hidden md:flex md:mx-5 text-default overflow-y-auto overflow-x-hidden md:overflow-y-visible md:overflow-x-auto md:justify-self-center" aria-label="Main navigation">
      <ul class="flex flex-col md:flex-row md:self-center w-full md:w-auto text-xl md:text-[0.9375rem] tracking-[0.01rem] font-medium md:justify-center">
        {{- range .Site.Menus.main }}
          {{- $isActive := eq .URL $currentPath -}}
          {{- if .HasChildren }}
          <li class="dropdown">
            <button type="button" class="hover:text-link dark:hover:text-white px-4 py-3 flex items-center whitespace-nowrap">
              {{ .Name }}
              <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5 ml-0.5 rtl:ml-0 rtl:mr-0.5 hidden md:inline" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <ul class="dropdown-menu md:backdrop-blur-md dark:md:bg-dark rounded md:absolute pl-4 md:pl-0 md:hidden font-medium md:bg-white/90 md:min-w-[200px] drop-shadow-xl">
              {{- range .Children }}
              {{- $childActive := eq .URL $currentPath -}}
              <li>
                {{- /* å¤„ç†é”šç‚¹é“¾æ¥ï¼šå¦‚æœæ˜¯ /#xxx æ ¼å¼ï¼Œè‡ªåŠ¨æ·»åŠ è¯­è¨€å‰ç¼€ */ -}}
                {{- $menuURL := .URL -}}
                {{- if hasPrefix $menuURL "/#" -}}
                  {{- $menuURL = printf "%s%s" ($.Site.Home.RelPermalink | strings.TrimSuffix "/") $menuURL -}}
                {{- end -}}
                <a class="first:rounded-t last:rounded-b md:hover:bg-gray-100 hover:text-link dark:hover:text-white dark:hover:bg-gray-700 py-2 px-5 block whitespace-nowrap{{ if $childActive }} aw-link-active{{ end }}" href="{{ $menuURL }}">
                  {{ .Name }}
                </a>
              </li>
              {{- end }}
            </ul>
          </li>
          {{- else }}
          <li>
            <a class="hover:text-link dark:hover:text-white px-4 py-3 flex items-center whitespace-nowrap{{ if $isActive }} aw-link-active{{ end }}" href="{{ .URL }}">
              {{ .Name }}
            </a>
          </li>
          {{- end }}
        {{- end }}
      </ul>
    </nav>
    
    {{- /* Actions - å³ä¾§æ“ä½œåŒºåŸŸ */ -}}
    <div class="hidden md:self-center md:flex items-center md:mb-0 fixed w-full md:w-auto md:static justify-end left-0 rtl:left-auto rtl:right-0 bottom-0 p-3 md:p-0 md:justify-self-end">
      <div class="items-center flex justify-between w-full md:w-auto">
        <div class="flex">
          {{- /* Search button */ -}}
          {{- if .Site.Params.search.enable }}
          <button 
            type="button" 
            class="text-muted dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 inline-flex items-center"
            aria-label="{{ i18n "search" | default "æœç´¢" }}"
            data-search-trigger
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"></path>
              <path d="M21 21l-6 -6"></path>
            </svg>
          </button>
          {{- end }}
          
          {{- /* Theme toggle */ -}}
          {{- if $showToggleTheme }}
          {{ partial "header/theme-toggle.html" . }}
          {{- end }}
          
          {{- /* RSS Feed */ -}}
          {{- if $showRssFeed }}
          <a class="text-muted dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 inline-flex items-center" aria-label="RSS Feed" href="{{ "index.xml" | absLangURL }}">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
            </svg>
          </a>
          {{- end }}
          
          {{- /* Language switcher */ -}}
          {{ partial "header/language-switcher.html" . }}
        </div>
        
        {{- /* Action buttons */ -}}
        {{- with .Site.Menus.actions }}
        <span class="ml-4 rtl:ml-0 rtl:mr-4">
          {{- range . }}
          <a class="btn btn-primary ml-2 py-2.5 px-5.5 md:px-6 font-semibold shadow-none text-sm w-auto" href="{{ .URL }}"{{ with .Params.target }} target="{{ . }}"{{ end }}{{ with .Params.rel }} rel="{{ . }}"{{ end }}>
            {{ .Name }}
          </a>
          {{- end }}
        </span>
        {{- end }}
      </div>
    </div>
  </div>
</header>
