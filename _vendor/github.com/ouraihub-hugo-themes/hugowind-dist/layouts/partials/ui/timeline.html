{{- /*
  Timeline 组件 - 复刻 AstroWind Timeline.astro
  参考: astrowind/src/components/ui/Timeline.astro
  
  参数:
    - items: 必需，时间线项数组
      - title: 项目标题
      - description: 项目描述
      - icon: 图标名称
    - defaultIcon: 可选，默认图标
    - classes: 可选，自定义样式类
      - container: 容器类
      - panel: 面板类
      - title: 标题类
      - description: 描述类
      - icon: 图标类
*/ -}}

{{- $items := .items | default slice -}}
{{- $defaultIcon := .defaultIcon | default "" -}}
{{- $classes := .classes | default dict -}}

{{- /* 样式类配置 */ -}}
{{- $containerClass := $classes.container | default "" -}}
{{- $panelClass := $classes.panel | default "" -}}
{{- $titleClass := $classes.title | default "" -}}
{{- $descriptionClass := $classes.description | default "" -}}
{{- $defaultIconClass := $classes.icon | default "text-primary dark:text-slate-200 border-primary dark:border-blue-700" -}}

{{- if and $items (gt (len $items) 0) -}}
<div class="{{ $containerClass }}">
  {{- range $index, $item := $items -}}
    {{- $itemClasses := $item.classes | default dict -}}
    <div class="flex intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade {{ $panelClass }} {{ $itemClasses.panel | default "" }}">
      {{- /* 左侧图标和连接线 */ -}}
      <div class="flex flex-col items-center mr-4 rtl:mr-0 rtl:ml-4">
        <div>
          <div class="flex items-center justify-center">
            {{- $iconName := $item.icon | default $defaultIcon -}}
            {{- if $iconName -}}
              {{- partial "ui/icon.html" (dict 
                "name" $iconName 
                "class" (printf "w-10 h-10 p-2 rounded-full border-2 %s %s" $defaultIconClass ($itemClasses.icon | default ""))
              ) -}}
            {{- end -}}
          </div>
        </div>
        {{- /* 连接线 - 最后一项不显示 */ -}}
        {{- if ne $index (sub (len $items) 1) -}}
        <div class="w-px h-full bg-black/10 dark:bg-slate-400/50"></div>
        {{- end -}}
      </div>
      
      {{- /* 右侧内容 */ -}}
      <div class="pt-1{{ if ne $index (sub (len $items) 1) }} pb-8{{ end }}">
        {{- with $item.title -}}
        <p class="text-xl font-bold {{ $titleClass }} {{ $itemClasses.title | default "" }}">
          {{ . | safeHTML }}
        </p>
        {{- end -}}
        {{- with $item.description -}}
        <p class="text-muted mt-2 {{ $descriptionClass }} {{ $itemClasses.description | default "" }}">
          {{ . | safeHTML }}
        </p>
        {{- end -}}
      </div>
    </div>
  {{- end -}}
</div>
{{- end -}}
