{{- /*
  Tag List Layout - 标签列表布局
  参考 AstroWind src/pages/[...blog]/[tag]/[...page].astro
  
  Requirements: 6.4
*/ -}}

{{- define "main" }}
<section class="px-4 md:px-6 py-12 sm:py-16 lg:py-20 mx-auto max-w-4xl">
  {{- /* 页面标题区域 */ -}}
  <header class="mb-8 md:mb-16 text-center max-w-3xl mx-auto">
    <p class="text-base text-secondary dark:text-blue-200 font-bold tracking-wide uppercase mb-2">
      {{ i18n "tag" | default "Tag" }}
    </p>
    <h1 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter font-heading dark:text-slate-200">
      {{ .Title }}
    </h1>
    <p class="mt-4 text-xl text-muted dark:text-slate-400">
      {{ i18n "posts_with_tag" (len .Pages) | default (printf "Posts tagged with '%s'" .Title) }}
    </p>
  </header>
  
  {{- /* 热门标签导航 */ -}}
  <div class="mb-12 flex flex-wrap justify-center gap-2">
    {{- /* 获取所有标签并按文章数量排序，显示前 20 个 */ -}}
    {{- $allTags := site.Taxonomies.tags.ByCount }}
    {{- range first 20 $allTags }}
    {{- $isActive := eq .Page.Title $.Title }}
    <a href="{{ .Page.RelPermalink }}" 
       class="inline-block px-3 py-1 text-sm rounded-full transition {{ if $isActive }}bg-primary text-white dark:bg-blue-600{{ else }}bg-gray-100 dark:bg-slate-700 text-muted dark:text-slate-300 hover:text-primary dark:hover:text-blue-400{{ end }}">
      {{ .Page.Title }}
      <span class="text-xs {{ if $isActive }}text-white/70{{ else }}text-gray-500 dark:text-slate-500{{ end }}">({{ .Count }})</span>
    </a>
    {{- end }}
  </div>
  
  {{- /* 文章列表 */ -}}
  {{- $paginator := .Paginate .Pages }}
  {{- if gt (len $paginator.Pages) 0 }}
  <ul>
    {{- range $paginator.Pages }}
    <li class="mb-12 md:mb-20">
      {{ partial "blog/list-item.html" . }}
    </li>
    {{- end }}
  </ul>
  
  {{- /* 分页 */ -}}
  {{ partial "blog/pagination.html" . }}
  {{- else }}
  <div class="text-center py-12">
    <p class="text-xl text-muted dark:text-slate-400">
      {{ i18n "no_posts" | default "No posts found." }}
    </p>
  </div>
  {{- end }}
</section>
{{- end }}
